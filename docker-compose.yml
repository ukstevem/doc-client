services:
  doc-client:
    build: .
    container_name: doc-client
    restart: unless-stopped
    working_dir: /app
    environment:
      NODE_ENV: development
      CHOKIDAR_USEPOLLING: "true"
      WATCHPACK_POLLING: "true"
      WATCHPACK_POLLING_INTERVAL: "1000"

      # Supabase (taken from .env on the Pi)
      SUPABASE_URL: ${SUPABASE_URL:-}
      SUPABASE_SECRET_KEY: ${SUPABASE_SECRET_KEY:-}
      SUPABASE_PUBLISHABLE_KEY: ${SUPABASE_PUBLISHABLE_KEY:-}

      # Inside container: NAS root is always here
      DOC_NAS_ROOT: /data/cad_iot
    ports:
      - "3000:3000"
    volumes:
      # App source + node_modules
      - .:/app
      - /app/node_modules

      # NAS root on the Pi host â†’ /data/cad_iot in the container
      # On the Pi, you mount //pss-dc02/cad_iot to /mnt/cad_iot
      - /mnt/cad_iot:/data/cad_iot
